pred=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="prediction" , level = 0.99 )
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,40),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot  fit line
abline (mfit , lwd =1,col="red")
#plot confidence interval
lines(1980:2013,conf[ ,2],col="black",lwd=1)
lines(1980:2013,conf[ ,3],col="black",lwd=1)
#plot prediction interval
lines(1980:2013,pred[ ,2],col="black",lwd=1,lty=4)
lines(1980:2013,pred[ ,3],col="black",lwd=1,lty=4)
legend("topright",c("Prediction interval(99%)","Confidence interval(99%)","Fitted Line"),lty=c(4,1,1),lwd=c(1,1,1),col=c("black","black","red"))
dev.new()
x=seq(-4,4,0.1)
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,35),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot(x,dnorm(x,0,summary(mfit)$sigma),type = 'l',xlim=c(-4,4),ylim=c(0,0.4))
polygon(1982+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[2,1]+c(-4, x, 4), col='gray95')
polygon(1990+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[10,1]+c(-4, x, 4), col='gray95')
polygon(2000+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[20,1]+c(-4, x, 4), col='gray95')
abline (mfit , lwd =1,col="red")
dev.new()
plot(pred[ ,1],summary(mfit)$residuals,xlab="Predicted Values",ylab = "Residual Error",main="Residual Error")
gfit=glm(ANMTEMP~1+Year,dataF,family=gaussian(link=identity))
summary(gfit)
help(dev)
help("dev")
help("dev.flush")
dev.off()
dev.new()
x=seq(-4,4,0.1)
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,35),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot(x,dnorm(x,0,summary(mfit)$sigma),type = 'l',xlim=c(-4,4),ylim=c(0,0.4))
polygon(1982+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[2,1]+c(-4, x, 4), col='gray95')
polygon(1990+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[10,1]+c(-4, x, 4), col='gray95')
polygon(2000+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[20,1]+c(-4, x, 4), col='gray95')
abline (mfit , lwd =1,col="red")
dev.new()
plot(pred[ ,1],summary(mfit)$residuals,xlab="Predicted Values",ylab = "Residual Error",main="Residual Error")
gfit=glm(ANMTEMP~1+Year,dataF,family=gaussian(link=identity))
summary(gfit)
dev.new()
x=seq(-4,4,0.1)
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,35),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot(x,dnorm(x,0,summary(mfit)$sigma),type = 'l',xlim=c(-4,4),ylim=c(0,0.4))
polygon(1982+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[2,1]+c(-4, x, 4), col='gray95')
polygon(1990+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[10,1]+c(-4, x, 4), col='gray95')
polygon(2000+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[20,1]+c(-4, x, 4), col='gray95')
abline (mfit , lwd =1,col="red")
dev.new()
plot(pred[ ,1],summary(mfit)$residuals,xlab="Predicted Values",ylab = "Residual Error",main="Residual Error")
gfit=glm(ANMTEMP~1+Year,dataF,family=gaussian(link=identity))
summary(gfit)
rm(list=ls())
#install.packages("xlsx")
require("xlsx")
setwd("/home/de/Dropbox/Hydroinformatics/Assignment 2/")
raw_data=read.xlsx("Temp_173040020_26.5_78.5.xls",sheetIndex = 1,header = FALSE)
dev.new()
summary(raw_data)
YearRain=raw_data[ ,c(1,4)]
annav=matrix(c(0),nrow = 34,ncol = 2)
for(i in 1:34){
ind = which(raw_data[ ,1]==1979+i)
annav[i,1]=1979+i
annav[i,2]=mean(YearRain[ind,2])
}
dataF=data.frame("Year" = annav[ ,1],"ANMTEMP" = annav[ ,2])
mfit=lm(ANMTEMP~Year,dataF)
summary(mfit)
summary(mfit)$r.squared
names(summary(mfit))
conf=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="confidence" , level = 0.99 )
pred=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="prediction" , level = 0.99 )
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,40),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot  fit line
abline (mfit , lwd =1,col="red")
#plot confidence interval
lines(1980:2013,conf[ ,2],col="black",lwd=1)
lines(1980:2013,conf[ ,3],col="black",lwd=1)
#plot prediction interval
lines(1980:2013,pred[ ,2],col="black",lwd=1,lty=4)
lines(1980:2013,pred[ ,3],col="black",lwd=1,lty=4)
legend("topright",c("Prediction interval(99%)","Confidence interval(99%)","Fitted Line"),lty=c(4,1,1),lwd=c(1,1,1),col=c("black","black","red"))
dev.new()
x=seq(-4,4,0.1)
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,35),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot(x,dnorm(x,0,summary(mfit)$sigma),type = 'l',xlim=c(-4,4),ylim=c(0,0.4))
polygon(1982+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[2,1]+c(-4, x, 4), col='gray95')
polygon(1990+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[10,1]+c(-4, x, 4), col='gray95')
polygon(2000+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[20,1]+c(-4, x, 4), col='gray95')
abline (mfit , lwd =1,col="red")
dev.new()
plot(pred[ ,1],summary(mfit)$residuals,xlab="Predicted Values",ylab = "Residual Error",main="Residual Error")
gfit=glm(ANMTEMP~1+Year,dataF,family=gaussian(link=identity))
summary(gfit)
lines(1980:2013,conf[ ,3],col="black",lwd=1)
rm(list=ls())
#install.packages("xlsx")
require("xlsx")
setwd("/home/de/Dropbox/Hydroinformatics/Assignment 2/")
raw_data=read.xlsx("Temp_173040020_26.5_78.5.xls",sheetIndex = 1,header = FALSE)
dev.new()
summary(raw_data)
YearRain=raw_data[ ,c(1,4)]
annav=matrix(c(0),nrow = 34,ncol = 2)
for(i in 1:34){
ind = which(raw_data[ ,1]==1979+i)
annav[i,1]=1979+i
annav[i,2]=mean(YearRain[ind,2])
}
dataF=data.frame("Year" = annav[ ,1],"ANMTEMP" = annav[ ,2])
mfit=lm(ANMTEMP~Year,dataF)
summary(mfit)
summary(mfit)$r.squared
names(summary(mfit))
conf=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="confidence" , level = 0.99 )
pred=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="prediction" , level = 0.99 )
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,40),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot  fit line
abline (mfit , lwd =1,col="red")
#plot confidence interval
lines(1980:2013,conf[ ,2],col="black",lwd=1)
lines(1980:2013,conf[ ,3],col="black",lwd=1)
#plot prediction interval
lines(1980:2013,pred[ ,2],col="black",lwd=1,lty=4)
lines(1980:2013,pred[ ,3],col="black",lwd=1,lty=4)
legend("topright",c("Prediction interval(99%)","Confidence interval(99%)","Fitted Line"),lty=c(4,1,1),lwd=c(1,1,1),col=c("black","black","red"))
dev.new()
x=seq(-4,4,0.1)
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,35),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot(x,dnorm(x,0,summary(mfit)$sigma),type = 'l',xlim=c(-4,4),ylim=c(0,0.4))
polygon(1982+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[2,1]+c(-4, x, 4), col='gray95')
polygon(1990+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[10,1]+c(-4, x, 4), col='gray95')
polygon(2000+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[20,1]+c(-4, x, 4), col='gray95')
abline (mfit , lwd =1,col="red")
dev.new()
plot(pred[ ,1],summary(mfit)$residuals,xlab="Predicted Values",ylab = "Residual Error",main="Residual Error")
gfit=glm(ANMTEMP~1+Year,dataF,family=gaussian(link=identity))
summary(gfit)
qt(0.99,32)
qt(0.995,32)
rm(list=ls())
#install.packages("xlsx")
require("xlsx")
setwd("/home/de/Dropbox/Hydroinformatics/Assignment 2/")
raw_data=read.xlsx("Temp_173040020_26.5_78.5.xls",sheetIndex = 1,header = FALSE)
dev.new()
summary(raw_data)
YearRain=raw_data[ ,c(1,4)]
annav=matrix(c(0),nrow = 34,ncol = 2)
for(i in 1:34){
ind = which(raw_data[ ,1]==1979+i)
annav[i,1]=1979+i
annav[i,2]=mean(YearRain[ind,2])
}
dataF=data.frame("Year" = annav[ ,1],"ANMTEMP" = annav[ ,2])
mfit=lm(ANMTEMP~Year,dataF)
summary(mfit)
summary(mfit)$r.squared
names(summary(mfit))
conf=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="confidence" , level = 0.99 )
pred=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="prediction" , level = 0.99 )
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,40),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot  fit line
abline (mfit , lwd =1,col="red")
#plot confidence interval
lines(1980:2013,conf[ ,2],col="black",lwd=1)
lines(1980:2013,conf[ ,3],col="black",lwd=1)
#plot prediction interval
lines(1980:2013,pred[ ,2],col="black",lwd=1,lty=4)
lines(1980:2013,pred[ ,3],col="black",lwd=1,lty=4)
legend("topright",c("Prediction interval(99%)","Confidence interval(99%)","Fitted Line"),lty=c(4,1,1),lwd=c(1,1,1),col=c("black","black","red"))
dev.new()
x=seq(-4,4,0.1)
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,35),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot(x,dnorm(x,0,summary(mfit)$sigma),type = 'l',xlim=c(-4,4),ylim=c(0,0.4))
polygon(1982+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[2,1]+c(-4, x, 4), col='gray95')
polygon(1990+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[10,1]+c(-4, x, 4), col='gray95')
polygon(2000+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[20,1]+c(-4, x, 4), col='gray95')
abline (mfit , lwd =1,col="red")
dev.new()
plot(pred[ ,1],summary(mfit)$residuals,xlab="Predicted Values",ylab = "Residual Error",main="Residual Error")
gfit=glm(ANMTEMP~1+Year,dataF,family=gaussian(link=identity))
summary(gfit)
rm(list=ls())
#install.packages("xlsx")
require("xlsx")
setwd("/home/de/Dropbox/Hydroinformatics/Assignment 2/")
raw_data=read.xlsx("Temp_173040020_26.5_78.5.xls",sheetIndex = 1,header = FALSE)
summary(raw_data)
YearRain=raw_data[ ,c(1,4)]
annav=matrix(c(0),nrow = 34,ncol = 2)
for(i in 1:34){
ind = which((raw_data[ ,1]==1979+i))
ind2= which(raw_data[ind,4]>33)
annav[i,1]=1979+i
annav[i,2]=length(ind2)
}
#par(mfrow=c(2,2))
dataF=data.frame("Year" = annav[ ,1],"ANMTEMP" = annav[ ,2])
plot(dataF$Year,dataF$ANMTEMP,xlim = c(1980,2013),ylim = c(0,35))
gfit1=glm(ANMTEMP~1,dataF,family=poisson(link=log))
gfit2=glm(ANMTEMP~1+Year,dataF,family=poisson(link=log))
summary(gfit1)
summary(gfit2)
conf=predict( gfit1, newdata=data.frame( Year= 1980:2013 ) )
points(1980:2013,exp(conf),pch=19,type='l',col="red")
conf=predict( gfit2, newdata=data.frame( Year= 1980:2013 ) )
points(1980:2013,exp(conf),pch=19,type='l',col="blue")
logLik(gfit1)
logLik(gfit2)
AIC(gfit1)
AIC(gfit2)
BIC(gfit1)
BIC(gfit2)
qchisq(.99, df=1)
D01=2*(logLik(gfit2)-logLik(gfit1))
rm(list=ls())
#install.packages("xlsx")
require("xlsx")
setwd("/home/de/Dropbox/Hydroinformatics/Assignment 2/")
raw_data=read.xlsx("Temp_173040020_26.5_78.5.xls",sheetIndex = 1,header = FALSE)
summary(raw_data)
YearRain=raw_data[ ,c(1,4)]
annav=matrix(c(0),nrow = 34,ncol = 2)
for(i in 1:34){
ind = which((raw_data[ ,1]==1979+i))
ind2= which(raw_data[ind,4]>33)
annav[i,1]=1979+i
annav[i,2]=length(ind2)
}
#par(mfrow=c(2,2))
dataF=data.frame("Year" = annav[ ,1],"ANMTEMP" = annav[ ,2])
#plot(dataF$Year,dataF$ANMTEMP,xlim = c(1980,2013),ylim = c(0,35))
gfit1=glm(ANMTEMP~1,dataF,family=poisson(link=log))
gfit2=glm(ANMTEMP~1+Year,dataF,family=poisson(link=log))
summary(gfit1)
summary(gfit2)
conf=predict( gfit1, newdata=data.frame( Year= 1980:2013 ) )
#points(1980:2013,exp(conf),pch=19,type='l',col="red")
conf=predict( gfit2, newdata=data.frame( Year= 1980:2013 ) )
#points(1980:2013,exp(conf),pch=19,type='l',col="blue")
logLik(gfit1)
logLik(gfit2)
AIC(gfit1)
AIC(gfit2)
BIC(gfit1)
BIC(gfit2)
qchisq(.99, df=1)
D01=2*(logLik(gfit2)-logLik(gfit1))
rm(list=ls())
#install.packages("xlsx")
require("xlsx")
setwd("/home/de/Dropbox/Hydroinformatics/Assignment 2/")
raw_data=read.xlsx("Temp_173040020_26.5_78.5.xls",sheetIndex = 1,header = FALSE)
summary(raw_data)
YearRain=raw_data[ ,c(1,4)]
annav=matrix(c(0),nrow = 34,ncol = 2)
for(i in 1:34){
ind = which((raw_data[ ,1]==1979+i))
ind2= which(raw_data[ind,4]>33)
annav[i,1]=1979+i
annav[i,2]=length(ind2)
}
#par(mfrow=c(2,2))
dataF=data.frame("Year" = annav[ ,1],"ANMTEMP" = annav[ ,2])
#plot(dataF$Year,dataF$ANMTEMP,xlim = c(1980,2013),ylim = c(0,35))
gfit1=glm(ANMTEMP~1,dataF,family=poisson(link=log))
gfit2=glm(ANMTEMP~1+Year,dataF,family=poisson(link=log))
summary(gfit1)
summary(gfit2)
conf=predict( gfit1, newdata=data.frame( Year= 1980:2013 ) )
#points(1980:2013,exp(conf),pch=19,type='l',col="red")
conf=predict( gfit2, newdata=data.frame( Year= 1980:2013 ) )
#points(1980:2013,exp(conf),pch=19,type='l',col="blue")
logLik(gfit1)
logLik(gfit2)
AIC(gfit1)
AIC(gfit2)
BIC(gfit1)
BIC(gfit2)
qchisq(.99, df=1)
D01=2*(logLik(gfit2)-logLik(gfit1))
rm(list=ls())
#install.packages("xlsx")
require("xlsx")
setwd("/home/de/Dropbox/Hydroinformatics/Assignment 2/")
raw_data=read.xlsx("Temp_173040020_26.5_78.5.xls",sheetIndex = 1,header = FALSE)
summary(raw_data)
YearRain=raw_data[ ,c(1,4)]
annav=matrix(c(0),nrow = 34,ncol = 2)
for(i in 1:34){
ind = which((raw_data[ ,1]==1979+i))
ind2= which(raw_data[ind,4]>33)
annav[i,1]=1979+i
annav[i,2]=length(ind2)
}
#par(mfrow=c(2,2))
dataF=data.frame("Year" = annav[ ,1],"ANMTEMP" = annav[ ,2])
#plot(dataF$Year,dataF$ANMTEMP,xlim = c(1980,2013),ylim = c(0,35))
gfit1=glm(ANMTEMP~1,dataF,family=poisson(link=log))
gfit2=glm(ANMTEMP~1+Year,dataF,family=poisson(link=log))
summary(gfit1)
summary(gfit2)
conf=predict( gfit1, newdata=data.frame( Year= 1980:2013 ) )
#points(1980:2013,exp(conf),pch=19,type='l',col="red")
conf=predict( gfit2, newdata=data.frame( Year= 1980:2013 ) )
#points(1980:2013,exp(conf),pch=19,type='l',col="blue")
logLik(gfit1)
logLik(gfit2)
AIC(gfit1)
AIC(gfit2)
BIC(gfit1)
BIC(gfit2)
qchisq(.99, df=1)
D01=2*(logLik(gfit2)-logLik(gfit1))
polygon(1982+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[2,1]+c(-4, x, 4), col='gray95')
rm(list=ls())
#install.packages("xlsx")
require("xlsx")
setwd("/home/de/Dropbox/Hydroinformatics/Assignment 2/")
raw_data=read.xlsx("Temp_173040020_26.5_78.5.xls",sheetIndex = 1,header = FALSE)
dev.new()
summary(raw_data)
YearRain=raw_data[ ,c(1,4)]
annav=matrix(c(0),nrow = 34,ncol = 2)
for(i in 1:34){
ind = which(raw_data[ ,1]==1979+i)
annav[i,1]=1979+i
annav[i,2]=mean(YearRain[ind,2])
}
dataF=data.frame("Year" = annav[ ,1],"ANMTEMP" = annav[ ,2])
mfit=lm(ANMTEMP~Year,dataF)
summary(mfit)
summary(mfit)$r.squared
names(summary(mfit))
conf=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="confidence" , level = 0.99 )
pred=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="prediction" , level = 0.99 )
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,40),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot  fit line
abline (mfit , lwd =1,col="red")
#plot confidence interval
lines(1980:2013,conf[ ,2],col="black",lwd=1)
lines(1980:2013,conf[ ,3],col="black",lwd=1)
#plot prediction interval
lines(1980:2013,pred[ ,2],col="black",lwd=1,lty=4)
lines(1980:2013,pred[ ,3],col="black",lwd=1,lty=4)
legend("topright",c("Prediction interval(99%)","Confidence interval(99%)","Fitted Line"),lty=c(4,1,1),lwd=c(1,1,1),col=c("black","black","red"))
dev.new()
x=seq(-4,4,0.1)
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,35),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot(x,dnorm(x,0,summary(mfit)$sigma),type = 'l',xlim=c(-4,4),ylim=c(0,0.4))
polygon(1982+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[2,1]+c(-4, x, 4), col='gray95')
polygon(1990+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[10,1]+c(-4, x, 4), col='gray95')
polygon(2000+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[20,1]+c(-4, x, 4), col='gray95')
abline (mfit , lwd =1,col="red")
dev.new()
plot(pred[ ,1],summary(mfit)$residuals,xlab="Predicted Values",ylab = "Residual Error",main="Residual Error")
gfit=glm(ANMTEMP~1+Year,dataF,family=gaussian(link=identity))
summary(gfit)
rm(list=ls())
#install.packages("xlsx")
require("xlsx")
setwd("/home/de/Dropbox/Hydroinformatics/Assignment 2/")
raw_data=read.xlsx("Temp_173040020_26.5_78.5.xls",sheetIndex = 1,header = FALSE)
dev.new()
summary(raw_data)
YearRain=raw_data[ ,c(1,4)]
annav=matrix(c(0),nrow = 34,ncol = 2)
for(i in 1:34){
ind = which(raw_data[ ,1]==1979+i)
annav[i,1]=1979+i
annav[i,2]=mean(YearRain[ind,2])
}
dataF=data.frame("Year" = annav[ ,1],"ANMTEMP" = annav[ ,2])
mfit=lm(ANMTEMP~Year,dataF)
summary(mfit)
summary(mfit)$r.squared
names(summary(mfit))
conf=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="confidence" , level = 0.99 )
pred=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="prediction" , level = 0.99 )
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,40),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot  fit line
abline (mfit , lwd =1,col="red")
#plot confidence interval
lines(1980:2013,conf[ ,2],col="black",lwd=1)
lines(1980:2013,conf[ ,3],col="black",lwd=1)
#plot prediction interval
lines(1980:2013,pred[ ,2],col="black",lwd=1,lty=4)
lines(1980:2013,pred[ ,3],col="black",lwd=1,lty=4)
legend("topright",c("Prediction interval(99%)","Confidence interval(99%)","Fitted Line"),lty=c(4,1,1),lwd=c(1,1,1),col=c("black","black","red"))
dev.new()
x=seq(-4,4,0.1)
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,35),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot(x,dnorm(x,0,summary(mfit)$sigma),type = 'l',xlim=c(-4,4),ylim=c(0,0.4))
polygon(1982+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[2,1]+c(-4, x, 4), col='gray95')
polygon(1990+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[10,1]+c(-4, x, 4), col='gray95')
polygon(2000+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[20,1]+c(-4, x, 4), col='gray95')
abline (mfit , lwd =1,col="red")
dev.new()
plot(pred[ ,1],summary(mfit)$residuals,xlab="Predicted Values",ylab = "Residual Error",main="Residual Error")
gfit=glm(ANMTEMP~1+Year,dataF,family=gaussian(link=identity))
summary(gfit)
rm(list=ls())
#install.packages("xlsx")
require("xlsx")
setwd("/home/de/Dropbox/Hydroinformatics/Assignment 2/")
raw_data=read.xlsx("Temp_173040020_26.5_78.5.xls",sheetIndex = 1,header = FALSE)
summary(raw_data)
YearRain=raw_data[ ,c(1,4)]
annav=matrix(c(0),nrow = 34,ncol = 2)
for(i in 1:34){
ind = which((raw_data[ ,1]==1979+i))
ind2= which(raw_data[ind,4]>33)
annav[i,1]=1979+i
annav[i,2]=length(ind2)
}
#par(mfrow=c(2,2))
dataF=data.frame("Year" = annav[ ,1],"ANMTEMP" = annav[ ,2])
#plot(dataF$Year,dataF$ANMTEMP,xlim = c(1980,2013),ylim = c(0,35))
gfit1=glm(ANMTEMP~1,dataF,family=poisson(link=log))
gfit2=glm(ANMTEMP~1+Year,dataF,family=poisson(link=log))
summary(gfit1)
summary(gfit2)
conf=predict( gfit1, newdata=data.frame( Year= 1980:2013 ) )
#points(1980:2013,exp(conf),pch=19,type='l',col="red")
conf=predict( gfit2, newdata=data.frame( Year= 1980:2013 ) )
#points(1980:2013,exp(conf),pch=19,type='l',col="blue")
logLik(gfit1)
logLik(gfit2)
AIC(gfit1)
AIC(gfit2)
BIC(gfit1)
BIC(gfit2)
qchisq(.99, df=1)
D01=2*(logLik(gfit2)-logLik(gfit1))
dev.new()
rm(list=ls())
#install.packages("xlsx")
require("xlsx")
setwd("/home/de/Dropbox/Hydroinformatics/Assignment 2/")
raw_data=read.xlsx("Temp_173040020_26.5_78.5.xls",sheetIndex = 1,header = FALSE)
dev.new()
summary(raw_data)
YearRain=raw_data[ ,c(1,4)]
annav=matrix(c(0),nrow = 34,ncol = 2)
for(i in 1:34){
ind = which(raw_data[ ,1]==1979+i)
annav[i,1]=1979+i
annav[i,2]=mean(YearRain[ind,2])
}
dataF=data.frame("Year" = annav[ ,1],"ANMTEMP" = annav[ ,2])
mfit=lm(ANMTEMP~Year,dataF)
summary(mfit)
summary(mfit)$r.squared
names(summary(mfit))
conf=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="confidence" , level = 0.99 )
pred=predict( mfit, data.frame( Year= 1980:2013 ) ,interval ="prediction" , level = 0.99 )
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,40),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot  fit line
abline (mfit , lwd =1,col="red")
#plot confidence interval
lines(1980:2013,conf[ ,2],col="black",lwd=1)
lines(1980:2013,conf[ ,3],col="black",lwd=1)
#plot prediction interval
lines(1980:2013,pred[ ,2],col="black",lwd=1,lty=4)
lines(1980:2013,pred[ ,3],col="black",lwd=1,lty=4)
legend("topright",c("Prediction interval(99%)","Confidence interval(99%)","Fitted Line"),lty=c(4,1,1),lwd=c(1,1,1),col=c("black","black","red"))
dev.new()
x=seq(-4,4,0.1)
plot(annav[ ,1],annav[ ,2],xlim = c(1980,2013),ylim = c(25,35),xlab="Years",ylab = "Annual Mean Temperatures(°C)",main="Regression Plot")
#plot(x,dnorm(x,0,summary(mfit)$sigma),type = 'l',xlim=c(-4,4),ylim=c(0,0.4))
polygon(1982+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[2,1]+c(-4, x, 4), col='gray95')
polygon(1990+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[10,1]+c(-4, x, 4), col='gray95')
polygon(2000+5*c(0,dnorm(x,0,summary(mfit)$sigma),0),pred[20,1]+c(-4, x, 4), col='gray95')
abline (mfit , lwd =1,col="red")
dev.new()
plot(pred[ ,1],summary(mfit)$residuals,xlab="Predicted Values",ylab = "Residual Error",main="Residual Error")
gfit=glm(ANMTEMP~1+Year,dataF,family=gaussian(link=identity))
summary(gfit)
rm(list=ls())
#install.packages("xlsx")
require("xlsx")
setwd("/home/de/Dropbox/Hydroinformatics/Assignment 2/")
raw_data=read.xlsx("Temp_173040020_26.5_78.5.xls",sheetIndex = 1,header = FALSE)
summary(raw_data)
YearRain=raw_data[ ,c(1,4)]
annav=matrix(c(0),nrow = 34,ncol = 2)
for(i in 1:34){
ind = which((raw_data[ ,1]==1979+i))
ind2= which(raw_data[ind,4]>33)
annav[i,1]=1979+i
annav[i,2]=length(ind2)
}
#par(mfrow=c(2,2))
dataF=data.frame("Year" = annav[ ,1],"ANMTEMP" = annav[ ,2])
#plot(dataF$Year,dataF$ANMTEMP,xlim = c(1980,2013),ylim = c(0,35))
gfit1=glm(ANMTEMP~1,dataF,family=poisson(link=log))
gfit2=glm(ANMTEMP~1+Year,dataF,family=poisson(link=log))
summary(gfit1)
summary(gfit2)
conf=predict( gfit1, newdata=data.frame( Year= 1980:2013 ) )
#points(1980:2013,exp(conf),pch=19,type='l',col="red")
conf=predict( gfit2, newdata=data.frame( Year= 1980:2013 ) )
#points(1980:2013,exp(conf),pch=19,type='l',col="blue")
logLik(gfit1)
logLik(gfit2)
AIC(gfit1)
AIC(gfit2)
BIC(gfit1)
BIC(gfit2)
qchisq(.99, df=1)
D01=2*(logLik(gfit2)-logLik(gfit1))
